{
  "info": {
    "name": "AgroMarket Backend",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Colección de pruebas para microservicios AgroMarket"
  },
  "variable": [
    { "key": "gateway_url", "value": "http://localhost:8080" },
    { "key": "accessToken", "value": "" },
    { "key": "email", "value": "usuario@example.com" }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/auth/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"Passw0rd!\",\n  \"role\": \"COMPRADOR\"\n}"
            }
          }
        },
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"Passw0rd!\"\n}"
            }
          }
        },
        {
          "name": "Refresh",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/auth/refresh",
            "body": { "mode": "raw", "raw": "{\n  \"refreshToken\": \"<coloca_refresh_token>\"\n}" }
          }
        },
        {
          "name": "Validate",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "text/plain" } ],
            "url": "{{gateway_url}}/auth/validate",
            "body": { "mode": "raw", "raw": "{{accessToken}}" }
          }
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "Get Profile",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" } ],
            "url": "{{gateway_url}}/users/profile"
          }
        },
        {
          "name": "Update Profile",
          "request": {
            "method": "PUT",
            "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" }, { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/users/profile",
            "body": { "mode": "raw", "raw": "{\n  \"nombres\": \"Nombre\",\n  \"apellidos\": \"Apellido\",\n  \"telefono\": \"999999999\",\n  \"compradorTipo\": \"MINORISTA\"\n}" }
          }
        },
        {
          "name": "List Addresses",
          "request": { "method": "GET", "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" } ], "url": "{{gateway_url}}/users/addresses" }
        },
        {
          "name": "Create Address",
          "request": {
            "method": "POST",
            "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" }, { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/users/addresses",
            "body": { "mode": "raw", "raw": "{\n  \"etiqueta\": \"Casa\",\n  \"direccionCompleta\": \"Av. Siempre Viva 123\",\n  \"ciudad\": \"Lima\",\n  \"departamento\": \"Lima\",\n  \"distrito\": \"Miraflores\",\n  \"referencia\": \"Puerta Blanca\"\n}" }
          }
        },
        {
          "name": "Update Address",
          "request": {
            "method": "PUT",
            "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" }, { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/users/addresses/{{addressId}}",
            "body": { "mode": "raw", "raw": "{\n  \"etiqueta\": \"Casa\",\n  \"direccionCompleta\": \"Av. Siempre Viva 456\",\n  \"ciudad\": \"Lima\",\n  \"departamento\": \"Lima\",\n  \"distrito\": \"Miraflores\",\n  \"referencia\": \"Puerta Negra\"\n}" }
          }
        },
        {
          "name": "Delete Address",
          "request": { "method": "DELETE", "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" } ], "url": "{{gateway_url}}/users/addresses/{{addressId}}" }
        },
        {
          "name": "Get Farm",
          "request": { "method": "GET", "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" } ], "url": "{{gateway_url}}/users/farm" }
        },
        {
          "name": "Update Farm",
          "request": {
            "method": "PUT",
            "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" }, { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/users/farm",
            "body": { "mode": "raw", "raw": "{\n  \"nombre\": \"Finca El Sol\",\n  \"ubicacion\": \"Cusco\",\n  \"descripcion\": \"Finca orgánica\"\n}" }
          }
        }
      ]
    },
    {
      "name": "Products",
      "item": [
        { "name": "List/Search", "request": { "method": "GET", "url": "{{gateway_url}}/products?q=manzana&minPrice=1&maxPrice=100" } },
        { "name": "Get By Id", "request": { "method": "GET", "url": "{{gateway_url}}/products/{{productId}}" } },
        {
          "name": "Create",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/products",
            "body": { "mode": "raw", "raw": "{\n  \"nombre\": \"Papa Orgánica\",\n  \"descripcion\": \"Papa andina\",\n  \"precio\": 3.5,\n  \"stock\": 50,\n  \"categoria\": \"Tubérculos\"\n}" }
          }
        },
        {
          "name": "Update",
          "request": {
            "method": "PUT",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/products/{{productId}}",
            "body": { "mode": "raw", "raw": "{\n  \"nombre\": \"Papa Orgánica Premium\",\n  \"descripcion\": \"Papa andina seleccionada\",\n  \"precio\": 4.0,\n  \"stock\": 60,\n  \"categoria\": \"Tubérculos\"\n}" }
          }
        },
        { "name": "Delete", "request": { "method": "DELETE", "url": "{{gateway_url}}/products/{{productId}}" } },
        { "name": "Categories", "request": { "method": "GET", "url": "{{gateway_url}}/products/categories" } },
        {
          "name": "Add Image",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/products/{{productId}}/images",
            "body": { "mode": "raw", "raw": "{\"url\": \"https://cdn.example.com/papa.jpg\"}" }
          }
        },
        {
          "name": "Add Review",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/products/{{productId}}/reviews",
            "body": { "mode": "raw", "raw": "{\n  \"calificacion\": 5,\n  \"comentario\": \"Excelente calidad\"\n}" }
          }
        }
      ]
    },
    {
      "name": "Inventory",
      "item": [
        { "name": "Get Stock", "request": { "method": "GET", "url": "{{gateway_url}}/inventory/{{productId}}" } },
        {
          "name": "Update Stock",
          "request": { "method": "PUT", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/inventory/{{productId}}", "body": { "mode": "raw", "raw": "{\n  \"stockActual\": 100,\n  \"stockMinimo\": 10\n}" } }
        },
        { "name": "Reserve", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/inventory/reserve?productId={{productId}}", "body": { "mode": "raw", "raw": "{\n  \"cantidad\": 2,\n  \"referencia\": \"orden-123\"\n}" } } },
        { "name": "Release", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/inventory/release?productId={{productId}}", "body": { "mode": "raw", "raw": "{\n  \"cantidad\": 1,\n  \"referencia\": \"orden-123\"\n}" } } },
        { "name": "Movements", "request": { "method": "GET", "url": "{{gateway_url}}/inventory/movements?productId={{productId}}" } }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "Create Order",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": "{{gateway_url}}/orders",
            "body": { "mode": "raw", "raw": "{\n  \"metodoPago\": \"STRIPE\",\n  \"metodoEnvio\": \"DELIVERY\",\n  \"costoEnvio\": 5.0,\n  \"descuento\": 0.0,\n  \"items\": [\n    { \"productoId\": \"{{productId}}\", \"cantidad\": 2, \"precioUnitario\": 3.5 }\n  ]\n}" }
          }
        },
        { "name": "Get Order", "request": { "method": "GET", "url": "{{gateway_url}}/orders/{{orderId}}" } },
        { "name": "List By State", "request": { "method": "GET", "url": "{{gateway_url}}/orders?state=CONFIRMADO" } },
        { "name": "Change State", "request": { "method": "PUT", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/orders/{{orderId}}/state", "body": { "mode": "raw", "raw": "{\"estado\": \"CONFIRMADO\"}" } } }
      ]
    },
    {
      "name": "Payments",
      "item": [
        { "name": "Stripe Intent", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/payments/stripe/intent", "body": { "mode": "raw", "raw": "{\n  \"monto\": 10.0,\n  \"moneda\": \"PEN\"\n}" } } },
        { "name": "Confirm Payment", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/payments/confirm", "body": { "mode": "raw", "raw": "{\n  \"pagoId\": \"{{pagoId}}\",\n  \"pasarela\": \"STRIPE\",\n  \"aprobar\": true\n}" } } },
        { "name": "Yape Simulate", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{accessToken}}" } ], "url": "{{gateway_url}}/payments/yape/simulate", "body": { "mode": "raw", "raw": "{\n  \"monto\": 10.0,\n  \"telefono\": \"999999999\"\n}" } } },
        { "name": "List Methods", "request": { "method": "GET", "header": [ { "key": "Authorization", "value": "Bearer {{accessToken}}" } ], "url": "{{gateway_url}}/payments/methods" } },
        { "name": "Save Method", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{accessToken}}" } ], "url": "{{gateway_url}}/payments/methods", "body": { "mode": "raw", "raw": "{\n  \"marca\": \"VISA\",\n  \"ultimos4\": \"4242\",\n  \"tokenizado\": \"tok_abc\"\n}" } } },
        { "name": "Refund", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/payments/refunds", "body": { "mode": "raw", "raw": "{\n  \"pagoId\": \"{{pagoId}}\"\n}" } } }
      ]
    },
    {
      "name": "Notifications",
      "item": [
        { "name": "Email", "request": { "method": "POST", "url": "{{gateway_url}}/notifications/email?destinatario={{email}}&mensaje=Hola" } },
        { "name": "SMS", "request": { "method": "POST", "url": "{{gateway_url}}/notifications/sms?destinatario=999999999&mensaje=Hola" } },
        { "name": "InApp", "request": { "method": "POST", "url": "{{gateway_url}}/notifications/inapp?destinatario={{email}}&mensaje=Hola" } },
        { "name": "List Templates", "request": { "method": "GET", "url": "{{gateway_url}}/notifications/templates" } },
        { "name": "Create Template", "request": { "method": "POST", "header": [ { "key": "Content-Type", "value": "application/json" } ], "url": "{{gateway_url}}/notifications/templates", "body": { "mode": "raw", "raw": "{\n  \"nombre\": \"bienvenida\",\n  \"tipo\": \"EMAIL\",\n  \"contenido\": \"Bienvenido a AgroMarket\"\n}" } } }
      ]
    }
  ]
}
